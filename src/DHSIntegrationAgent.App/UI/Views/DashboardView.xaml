<UserControl x:Class="DHSIntegrationAgent.App.UI.Views.DashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.WPF;assembly=LiveChartsCore.SkiaSharpView.WPF"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="18">

            <Grid Margin="10,0,10,14">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel>
                    <TextBlock Text="Dashboard" FontSize="20" FontWeight="SemiBold"/>
                    <TextBlock Text="Stream health and operational counts (screen-only wiring here)."
                               Foreground="{StaticResource BrushMuted}" Margin="0,4,0,0"/>
                </StackPanel>
                <Button   FontSize="13.5" Height="33" Margin="5,0" BorderBrush="#32729B"  Foreground="#32729B"
                          Style="{StaticResource MaterialDesignOutlinedButton}" materialDesign:ButtonAssist.CornerRadius="5" 
                          Cursor="Hand"    
                         Grid.Column="1" Command="{Binding RefreshCommand}">

                    <StackPanel  Margin="0,0,0,0" Orientation="Horizontal" HorizontalAlignment="Left">
                        <materialDesign:PackIcon Kind="Sync" Width="17" Height="17" Margin="0,0,5,0"/>
                        <TextBlock  VerticalAlignment="Center" Foreground="#32729B" > Refresh</TextBlock>
                    </StackPanel> 
                </Button> 
            </Grid>

            <!--Start count cards-->
            <Grid Margin="0,10,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>

                <!-- Staged -->
                <Border Grid.Column="0" Style="{StaticResource DashboardCardStyle}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>

                        <Border Width="45" Height="45" CornerRadius="12" Background="#785ca3">
                            <materialDesign:PackIcon Kind="PackageVariant"
                                         Width="23"
                                         Height="23"
                                         Foreground="White"
                                         HorizontalAlignment="Center"
                                         VerticalAlignment="Center"/>
                        </Border>

                        <StackPanel Grid.Column="1" Margin="16,0,0,0">
                            <TextBlock Text="Staged" Foreground="#6c757d"/>
                            <TextBlock  Text="{Binding StagedCount}" FontSize="28" FontWeight="Bold"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Enqueued -->
                <Border Grid.Column="1" Style="{StaticResource DashboardCardStyle}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>

                        <Border Width="45" Height="45" CornerRadius="12" Background="#3f8fc1">
                            <materialDesign:PackIcon Kind="TimerSand"
                                         Width="22"
                                         Height="22"
                                         Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Border>

                        <StackPanel Grid.Column="1" Margin="16,0,0,0">
                            <TextBlock Text="Enqueued" Foreground="#6c757d"/>
                            <TextBlock Text="{Binding EnqueuedCount}" FontSize="28" FontWeight="Bold"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Completed -->
                <Border Grid.Column="2" Style="{StaticResource DashboardCardStyle}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>

                        <Border Width="45" Height="45" CornerRadius="12" Background="#008080">
                            <materialDesign:PackIcon Kind="CheckCircle"
                                         Width="22"
                                         Height="22"
                                         Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Border>

                        <StackPanel Grid.Column="1" Margin="16,0,0,0">
                            <TextBlock Text="Completed" Foreground="#6c757d"/>
                            <TextBlock Text="{Binding CompletedCount}" FontSize="28" FontWeight="Bold"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Failed -->
                <Border Grid.Column="3" Style="{StaticResource DashboardCardStyle}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>

                        <Border Width="45" Height="45" CornerRadius="12" Background="#dc3545">
                            <materialDesign:PackIcon Kind="CloseCircle"
                                         Width="22"
                                         Height="22"
                                         Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Border>

                        <StackPanel Grid.Column="1" Margin="16,0,0,0">
                            <TextBlock Text="Failed" Foreground="#6c757d"/>
                            <TextBlock Text="{Binding FailedCount}" FontSize="28" FontWeight="Bold"/>
                        </StackPanel>
                    </Grid>
                </Border> 
            </Grid>
            
            <!--Start bar Charts-->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition/> 
                </Grid.ColumnDefinitions>
                <!-- Bar Chart1 -->
                <Border Grid.Column="0" Style="{StaticResource DashboardCardStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <Border Grid.Row="0" Margin="0,0,0,5" > 
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Width="189" >
                                <materialDesign:PackIcon Foreground="#4a6fa5" Kind="ChartBar" Width="23" Height="23" Margin="0,0,5,0"/>
                                <TextBlock Style="{StaticResource CardTitle}"> Bar Chart</TextBlock>
                            </StackPanel>
                        </Border>
                        <Border  Grid.Row="1" Height="270">
                            <materialDesign:Card Padding="16"  x:Name="CardChart"/>

                      </Border>
                    </Grid> 
                </Border>
                <!-- Pie Chart2 -->
                <Border  Grid.Column="1" Style="{StaticResource DashboardCardStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <Border Grid.Row="0" Margin="0,0,0,5" >
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Width="189" >
                                <materialDesign:PackIcon Foreground="#4a6fa5" Kind="ChartPie" Width="23" Height="23" Margin="0,0,5,0"/>
                                <TextBlock Style="{StaticResource CardTitle}"> Pie Chart</TextBlock>
                            </StackPanel>
                        </Border>
                        <Border  Grid.Row="1" Height="270">
                            <materialDesign:Card x:Name="CardPieChart" Padding="16" />

                        </Border>
                    </Grid>
                </Border>
            </Grid>
            
            <!--Start Provider Info -->
            <Grid>
             
                <Border Style="{StaticResource DashboardCardStyle}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel>
                            <TextBlock Text="Provider DHS Code" Foreground="{StaticResource BrushMuted}"/>
                            <TextBlock Text="{Binding ProviderDhsCode}" FontSize="16" FontWeight="SemiBold" Margin="0,4,0,0"/>
                        </StackPanel>

                        <StackPanel Grid.Column="1">
                            <TextBlock Text="Last activity (UTC)" Foreground="{StaticResource BrushMuted}"/>
                            <TextBlock Text="{Binding LastFetchUtc, StringFormat=Last Fetch: {0}}" Margin="0,6,0,0"/>
                            <TextBlock Text="{Binding LastSendUtc, StringFormat=Last Send: {0}}" Margin="0,2,0,0"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid> 
        </StackPanel>
    </ScrollViewer>
</UserControl>
